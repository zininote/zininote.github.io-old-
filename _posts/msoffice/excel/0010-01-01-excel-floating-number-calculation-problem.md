---
layout: post
title: "소수점 계산할 때 주의할 점"
updated: 2021-08-06
tags: [msoffice,excel]
---

## 엑셀 소수점 계산 문제

엑셀을 열고 `= 3.3 - 3.2` 라고 수식을 넣어보자. 화면에는 당연한 듯 0.1 이라고 표시가 된다. 당연히 아무런 문제가 없다. 하지만 셀의 소수점 자릿수를 늘려보자. 늘리다보면 어느순간에 뭔가 잘못되어가고 있다는 걸 느낄 것이다.

![그림00](/img/msoffice/excel/excel-0000.png)

버그 인가? 하지만 버그는 아니다. 오히려 **엑셀 소수점 계산에는 정밀도에 오차가 있다**라고 이해하는 것이 좋다.

[MS 도움말](https://docs.microsoft.com/ko-KR/office/troubleshoot/excel/floating-point-arithmetic-inaccurate-result)을 참고해보면 그 이유를 알 수 있다. 요약하면 메모리 물리적 한계로 정확하게 표현가능한 소수점 자릿수에는 한계가 있을 수밖에 없고, 따라서 완벽한 정밀함을 기대할 수 없다는 내용이다. 도움말을 더 읽어보면 소수점 뿐만아니라 아주 큰 수의 계산에 있어서도 오류가 나올 수 있다고 한다.

실무에서 엑셀 작업을 할 땐, 나눗셈을 하여 보통 백만/억 단위로 자릿수를 바꿔 작업하는 경우가 많다. 필연적으로 소수점 이하 자리가 생기는데 일반적으론 큰 문제가 되지 않는다.

하지만 1 원의 차이마저도 용납할 수 없는 작업의 경우라면, 되도록 소수점 이하 자릿수를 만들지 않고 작업을 하는 것이 좋다. 엑셀 "셀 서식" (CTRL + 1) 지정 화면에서 "사용자 지정" 에 `#,##0,,`  을 입력하면, 백만단위 이상만 보여주므로 나눗셈 대신 이런 방식을 활용하는 것도 좋은 방법이다.

구체적인 셀서식 지정 방법은 [오피스 도움말](https://support.microsoft.com/ko-kr/office/%ec%88%ab%ec%9e%90-%ec%84%9c%ec%8b%9d%ec%9d%84-%ec%82%ac%ec%9a%a9%ec%9e%90-%ec%a7%80%ec%a0%95%ed%95%98%eb%8a%94-%ec%a7%80%ec%b9%a8-c0a1d1fa-d3f4-4018-96b7-9c9354dd99f5?ui=ko-kr&rs=ko-kr&ad=kr)을 참고하자.