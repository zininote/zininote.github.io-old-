---
layout: post
title: "SUMPRODUCT: 특정범위 안에 포함된 내역과 일치하는 항목들의 개수, 합계 구하기"
updated: 2021-08-16
tags: [msoffice,formula]
---

## 특정 조건범위 내역과 일치여부 조사

엑셀에서 두 범위를 지정했을 때, 한 범위 안의 어떤 항목이 다른 범위 안에 포함되어 있을 때, 포함된 항목들만의 개수나 합계를 구할 수 있는 방법이 있다. 주어진 두 범위의 일치하는 항목들의 개수나 합계를 구하면 된다.

![그림00](/img/msoffice/formula/formula-0018.png)

```excel
= SUMPRODUCT( COUNTIFS( 데이터범위, 조건범위 ))
= SUMPRODUCT( SUMIFS( 합계대상데이터, 데이터범위, 조건범위 ))
```
{:.excel}

`데이터범위`와 `조건범위`가 주어졌을 때, 위 함수식은 두 범위에서 공통적으로 일치하는 항목들의 개수를, 아래 함수식은 합계를 구해준다.

위 그림에서도 휴일에 근무한 날을 파악하기 위해 언제가 휴일인지 미리 `조건범위` (E 열) 를 지정하고, 실제 근무일을 나타내는 `데이터범위` (B 열) 와 비교하여 휴일에 해당하는 날짜의 근무일 수와 근무시간을 구하고 있다.

## 함수식 이해

함수식 내부에 쓰인 COUNTIFS 와 SUMIFS 가 보통 사용하는 형식과는 다르게 사용되었다. 이 두 함수의 `조건범위` 부분에는 일반적으로 특정값이나 단순 비교가 들어가지만, 이와 같이 범위를 넣게 되면 `데이터범위`에 해당하는 항목들이 `조건범위`의 항목들에 포함되어 있는지 여부를 하나하나 조사하여 다시 배열로 반환하게 된다. 이를 SUMPRODUCT 함수가 받아서 처리하는 구조이다.