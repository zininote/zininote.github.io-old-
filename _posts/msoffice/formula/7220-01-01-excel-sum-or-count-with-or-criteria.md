---
layout: post
title: "SUMPRODUCT: 복수의 조건들을 OR 로 만족시키는 항목들의 개수, 합계 구하는 방법"
updated: 2021-08-13
tags: [msoffice,formula]
---

## 복수의 조건들을 OR 로 만족

주어진 여러 조건들을 만족하는 항목들의 개수나 합계를 구할 때는 COUNTIFS 나 SUMIFS 함수를 사용하면 된다. 이 함수들은 반드시 모든 조건에 부합하는 (즉 AND 조건) 항목의 개수나 합계 결과를 보여준다.

때로는 조건들에 모두 부합하는 항목이 아닌, 주어진 조건들 중 하나라도 부합하는 (즉 OR 조건) 항목들로 계산을 하고 싶을 때가 있다. COUNTIFS 나 SUMIFS 의 OR 조건 만족 버전이라 생각하면 된다.

![그림00](/img/msoffice/formula/formula-0016.png)

```excel
= SUMPRODUCT( --( (조건식)+(조건식)+ ... +(조건식) > 0 ))
= SUMPRODUCT( --( (조건식)+(조건식)+ ... +(조건식) > 0 ), 합계범위 )
```
{:.excel}

위쪽 함수식은 개수를, 아래쪽 함수식은 합계를 구한다. 각 `조건식` 들을 + 기호로 연결하는 것만으로 OR 조건 추가가 가능하다.

## 함수식 이해

먼저 엑셀은 True 혹은 False 에 + 와 같은 사칙연산자를 적용하면 각각 1 과 0 으로 치환하여 계산한다. 그리고 `조건식`의 결과는 True 혹은 False 이다. 이 결과들을 + 연산자로 연결했기 때문에 True 가 하나라도 있게 되면 조건들의 합은 1 이상이 나올 것이므로 `(조건식)+(조건식)+...+(조건식) > 0` 의 결과는 True 가 된다. 만일 어떠한 조건에도 부합하지 않는다면 조건들의 합은 0 이므로 `(조건식)+(조건식)+...+(조건식) > 0` 의 결과는 False 가 된다.

이 결과를 -- 연산자가 받는데 이는 기호 그대로 - 를 두번한 것이다. 마이너스를 두번하면 결국은 원래의 수가 되므로 의미가 없는 것이지만, `--( ... > 0 )` 의 내부 결과가 True 혹은 False 이므로 강제로 1 또는 0 이라는 숫자로 전환하기 위해 사용된 것이다. 이 결과를 SUMPRODUCT 함수가 처리하는 구조다.

참고로, 위 수식에서 `조건식`들을 연결한 + 기호를 * 기호로 바꾸게 되면 COUNTIFS, SUMIFS 함수와 동일하게 AND 조건으로 개수, 합계를 구하는 함수식이 된다.

또한 + 와 * 기호를 잘 조합하면 OR 와 AND 조건이 혼합된 복잡한 함수식도 구현할 수 있다.