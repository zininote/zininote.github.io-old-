---
layout: post
title: "MOD: 어떤 연도가 윤년인지 알아내는 함수식"
updated: 2021-08-09
tags: [msoffice,formula]
---

## 윤년 판별 공식

어떤 연도가 윤년인지 아닌지 판별하려면 아래와 같은 규정을 위부터 아래로 순서대로 적용해보면 된다. (윤년이 아닌 해는 "평년"이라 하였다.) 

- 어떤 연도가 400 으로 나누어 떨어진다면 그 해는 "윤년"
- 100 으로 나누어 떨어진다면 그 해는 "평년"
- 4 로 나누어 떨어진다면 그 해는 "윤년"
- 위 모든 경우에 해당되지 않는다면 그 해는 "평년"
{:.information}

아래부터는 윤년인지 아닌지를 알려주는 함수식을 소개해본다.

## 윤년 공식을 사용하는 방법

```excel
= IF( MOD(연도,400)=0, "윤년", IF( MOD(연도,100)=0, "평년", IF( MOD(연도,4)=0, "윤년", "평년" )))
```
{:.excel}

위에서 언급한 윤년 판별 공식이 위부터 순서대로 적용된다는 점에 착안하여 세운 수식이다. `연도` 자리에는 "2019" 처럼 정확히 숫자로 표현된 연도를 넣으면 된다. 나눗셈의 나머지를 구하는 MOD 함수가 함수식 구현의 핵심이다.

## 기타 방법 (비추천)

```excel
= IF( MONTH( DATE( 연도, 2, 29 )) = 2, "윤년", "평년" )
```
{:.excel}

MONTH, DATE 함수로도 윤년인지 아닌지를 판별할 수 있는데, 어떤 연도 의 2월 29일을 만들고서는 이 날이 실제로 존재하는 달 (즉 2 월) 인지를 판단하는 식으로 되어있다. 만일 윤년이 아니라면 위에서 `MONTH( DATE( 연도, 2, 29 ))` 의 결과는 3 이다.

하지만 엑셀에는 1900 년이 윤년이 아님에도 윤년으로 판단하는 버그가 있기 때문에 **이를 사용한 함수식은 사용하지 않는 편이 좋다.**

실제로 함수식 연도 자리에 "1900" 을 대입하면 "윤년" 이라는 결과가 나온다. 또한 엑셀 셀에 "1900-2-29" 라고 입력하면 날짜 형식으로 제대로 인식도 한다. 이는 버그이기는 하지만 이는 엑셀이 일부러 유지하는 버그이다. 엑셀 이전의 소프트웨어들과 호환성을 유지하기 위해 당시 소프트웨어가 안고 있던 버그도 그대로 수용했다고 한다. [MS 도움말](https://docs.microsoft.com/ko-KR/office/troubleshoot/excel/wrongly-assumes-1900-is-leap-year)을 참고하자.

또다른 문제점도 있다. 엑셀은 날짜를 1900 년 1 월 1 일 부터 9999 년 12 월 31 일 까지만 인식한다는 점 때문에 발생하는 문제다. DATE, MONTH 함수도 엑셀 날짜를 이용하기 때문에 1900 ~ 9999 년 이외의 연도는 제대로 된 결과가 나오지 않는다. (물론 윤년버그로 인해 1900 년은 무조건 잘못된 결과가 나온다.)

결국 DATE, MONTH 함수식은 훨씬 간단함에도 불구하고 쓰지 않는 것이 좋다.