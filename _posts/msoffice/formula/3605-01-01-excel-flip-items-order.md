---
layout: post
title: "INDEX: 열에 있는 항목들의 순서를 뒤집어서 재나열하는 함수식"
updated: 2021-08-18
tags: [msoffice,formula]
---

## 항목 순서 뒤집기

어떤 열의 항목들의 위 아래 순서를 뒤집어서 다시 재나열하는 함수식이다. 함수식이기 때문에 원래 항목들의 값이나 위치가 바뀌면, 함수식 결과에도 자동으로 반영된다.

![그림00](/img/msoffice/formula/formula-0026.png)

```excel
= INDEX( 목록범위, ROWS( 변형된목록범위 ))
```
{:.excel}

`목록범위`는 뒤집기를 원하는 원래의 항목들 범위를 지정하면 된다. 문제는 `변형된목록범위`인데, `목록범위`와 지정하는 범위는 동일하지만 상대/절대 참조 모양이 다르다. 위 그림을 보더라도 범위의 앞부분은 상대참조, 뒷부분은 절대참조로 되어있다.

변형된 참조형태로 인해 아래로 복사했을 때, ROWS 에 인수로 적용되는 범위가 달라지게 된다.

## 함수식 이해

ROWS 함수는 주어진 범위의 열개수를 반환한다. 위 그림으로 보자면, C5 셀의 ROWS 값은 7 이 된다. 이를 INDEX 함수가 받아서 원래 범위의 7 번째 항목, 즉 제일 마지막 항목을 가져온다.

이제 C6 셀의 ROWS 값은 6 이 되는데, `변형된목록범위`의 상대/절대 참조 때문에 그렇게 된다. 이를 INDEX 함수가 받으면 위에서 6 번째, 아래서 두번째 항목을 가져온다. 이런 식으로 작동하는 구조다.