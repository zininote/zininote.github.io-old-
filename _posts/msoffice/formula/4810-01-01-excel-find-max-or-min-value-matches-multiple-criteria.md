---
layout: post
title: "MAX,MIN: 조건들에 부합하는 항목들 중 최대값이나 최소값 구하기"
updated: 2021-08-16
tags: [msoffice,formula]
---

## 조건 부합 최대값, 최소값 구하기

아래는 복수의 조건을 만족시키는 항목들 중 최대값이나 최소값을 구하고 있는 예시다.

![그림00](/img/msoffice/formula/formula-0024.png)

```excel
{= MAX( IF( (조건식)*(조건식)* ... *(조건식), 검색대상열 ))}
{= MIN( IF( (조건식)*(조건식)* ... *(조건식), 검색대상열 ))}
```
{:.excel}

각각 MAX, MIN 함수가 쓰였으니 그 의미는 쉽게 알 수 있을 것이다. 중괄호를 제외한 나머지 수식을 입력하고, CTRL + SHIFT + ENTER 키를 눌러 **배열수식으로 입력**해야 제대로 작동한다. 입력 후 셀에 포커싱을 둬보면, 입력하지도 않은 중괄호가 보이는데 이는 배열수식으로 입력되어있다는 표식이다.

그리고 `(조건식)`들을 * 기호로 연결하기만 하면 만족해야하는 조건식을 계속 추가해 갈 수 있다.

사용에 다소 주의가 필요하다. 만일 **배열수식 입력을 잊어버리거나 만족하는 항목을 찾을 수 없을 경우에는 에러가 아닌 0 과 같은 엉뚱한 값**을 내어놓는다. 따라서 입력을 잘못했다는 것을 놓치고 넘어갈 수 있으니 조심해야 한다.

## 함수식 이해

`(조건식)`의 결과값은 true 혹은 false 둘 중의 하나이다. 이 결과에 산술 기호를 사용하면 엑셀은 true 는 1 로, flase 는 0 으로 바꿔서 계산한다. 또한 IF 함수의 첫번째 인수 자리에 숫자가 올 경우 0 은 false 로 , 0 이외의 숫자는 true 로 판단한다.

조건들을 모두 만족했을 때만 IF 함수의 첫번째 인수가 true 가 되므로, 그 경우에만 검색대상열의 값들을 가져온다. 가져온 값들을 MAX 또는 MIN 함수에 대입하여 원하는 결과를 도출하는 구조이다.